var nerdamer=function(){function r(e,t){var i="hash"===t;if(P(e)){var s="",o="",a="",n=e.group,l=e.value;if(!i){var u=e.multiplier;-1===u&&(a="-",u=1),1!==u&&(s=u);var p=e.power;1!==p&&(o=P(p)?r(p):p)}switch(n){case c:s="",l=-1===e.multiplier?1:e.multiplier,o="";break;case y:l=e.collectSymbols(r).join("+").replace("+-","-");break;case w:l=e.collectSymbols(r).join("+").replace("+-","-");break;case g:l=e.collectSymbols(function(e){var t=e.group;return t!==y&&t!==w||1!==e.power||1!==e.multiplier?r(e):O(r(e))}).join("*");break;case v:var f=e.previousGroup,h=e.power.group;f===y&&(l=e.collectSymbols(r).join("+").replace("+-","-")),f!==c&&f!==m&&f!==b&&(l=O(l)),h!==w&&h!==g&&h!==y&&1===e.power.multiplier||!o||(o=O(o))}return((n===w||n===y)&&s&&1!==s||(n===g||n===w||n===y)&&o&&1!==o||e.baseName===d)&&(l=O(l)),0>o&&(o=O(o)),s&&(s+="*"),o&&(o="^"+o),a+s+l+o}return e}function e(r){this.name=r}function t(r){this.symbol=r}function i(r){return this instanceof i?(isNaN(r)?("i"===r&&(this.isImgSymbol=!0),this.group=m,U(r),this.value=r,this.multiplier=1,this.power=1):(this.group=c,this.value="#",this.multiplier=Number(r)),this):new i(r)}function s(r,e,t,i,s,o){this.val=r,this.fn=e,this.precedence=t,this.left_assoc=i,this.is_prefix=s,this.is_postfix=o||!1}function o(r){this.val=r}function a(){function r(r){return h.PARSE2NUMBER?r:p.symfunction("parens",[r])}function t(r){return r.multiplier<0&&(r.multiplier*=-1),G(r)||Z(r.power)?r:p.symfunction(x,[r])}function a(r){return p.pow(r,new i("0.5"))}function l(r){var e;if(r.group===b&&"exp"===r.baseName){var t=r.args[0];e=1===r.multiplier?p.multiply(t,new i(r.power)):p.symfunction("log",[r])}else if(h.PARSE2NUMBER&&G(r)){var s;r.multiplier<0&&(r.negate(),s=p.multiply(new i(Math.PI),new i("i"))),e=new i(Math.log(r.multiplier)),s&&(e=p.add(e,s))}else e=p.symfunction("log",arguments);return e}function u(){return new n([].slice.call(arguments))}var p=this,f={},S=this.constants={PI:Math.PI,E:Math.E},A={"^":new s("^","pow",4,!1,!1),"*":new s("*","multiply",3,!0,!1),"/":new s("/","divide",3,!0,!1),"+":new s("+","add",2,!0,!0),"-":new s("-","subtract",2,!0,!0),",":new s(",","comma",1,!0,!1)},k=this.functions={cos:[,1],sin:[,1],tan:[,1],sec:[,1],csc:[,1],cot:[,1],acos:[,1],asin:[,1],atan:[,1],exp:[,1],min:[,-1],max:[,-1],erf:[,1],floor:[,1],ceiling:[,1],fact:[,1],round:[,1],mod:[,2],vector:[u,-1],parens:[r,-1],sqrt:[a,1],log:[l,1],abs:[t,1]},U={},C=function(r){return r[r.length-1]},R="(",F=")",O="[",q="]",I=[];U[R]=R,U[F]=F,U[O]=O,U[q]=q,this.error=E,this.override=function(r,e){f[r]||(f[r]=[]),f[r].push(this[r]),this[r]=e},this.restore=function(r){this[r]&&(this[r]=f[r].pop())},this.extend=function(r,e,t){var i=this,s=this[r];if("function"==typeof s&&"function"==typeof e){var o=this[r];this[r]=function(r,s){return P(r)&&P(s)&&!t?o.call(i,r,s):e.call(i,r,s,o)}}},this.symfunction=function(r,e){var t=new i(r);return t.group=b,"object"==typeof e&&(e=[].slice.call(e)),t.args=e,t.baseName=r,t.updateHash(),t},this.callfunction=function(r,e){var t=k[r];t||E(r+" is not a supported function.");var s,o=t[1],a=t[0];if(e instanceof Array||(e=void 0!==e?[e]:[]),-1!==o){var n=z(o),l=n?o[0]:o,u=n?o[1]:o,p=e.length,f=r+" requires a {0} of {1} arguments. {2} provided!";l>p&&E(j(f,"minimum",l,p)),p>u&&E(j(f,"maximum",u,p))}if(a)s=a.apply(t[2]||this,e);else if(h.PARSE2NUMBER)try{e=e.map(function(r){return r.group===c?r.multiplier:void E("Symbol must be of group N.")});var m=Math[r]?Math[r]:J[r];s=new i(m.apply(void 0,e))}catch(v){s=this.symfunction(r,e)}else s=this.symfunction(r,e);return s},this.powerAdd=function(r,e,t){var s=!isNaN(e);if(!s||t||P(r.power)){var o=P(e)?e:new i(e);r.power=p.add(r.power,o)}else r.power+=e;0===r.power.valueOf()&&r.convert(c)},this.parse=function(r,t){r=r.split(" ").join("").replace(/\d*\.*\d+e[\+\-]*\d+/gi,function(r,e,t){return/[a-z_]/.test(t.charAt(e-1))?r:(I.push(r),"&")}).replace(/([\+\-\/\*]*[0-9]+)([a-z_]+[\+\-\/\*]*)/gi,function(){var r=arguments[4],e=arguments[1],t=arguments[2],i=arguments[3],s=r.charAt(i),o="",a="*";return s.match(/[\+\-\/\*]/)||(o=r.charAt(i-1)),o.match(/[a-z]/i)&&(a=""),e+a+t}).replace(/\)\(/g,")*(");var s,a,n,l=t||{},u=[],f=[],h=r.length,c=0,m=!1,v=!1,b=0,y=function(r){r||(r=u.pop());var e=f.pop(),t=f.pop();if(r||t||!e)if(r===R)m&&E("Unmatched open parenthesis!"),u.push(r),g(t),g(e);else{var i,s=r.fn;i=s?p[s].call(p,t,e):r.resolve(e),g(i)}else g(e)},g=function(e){if(/&/.test(e)&&(e=I.shift()),""!==e&&void 0!==e){if(!(e instanceof Array||e instanceof i||B(e))){var t=l[e]||N[e];e=t?t.copy():new i(e)}for(;C(u)instanceof o;){if(v){var s=A[r.charAt(b+1)];if(s&&!s.left_assoc)break}if(x&&!x.left_assoc)break;var a=u.pop();e=a.resolve(e)}f.push(e),v=!1}};if(!l["~"])for(var w in S)l[w]=new i(S[w]);for(b=0;h>b;b++){var d=r.charAt(b),x=A[d],k=U[d];if(x||k){var P=r.substring(c,b);if(k===R&&P||k===O){var G=k===O?M:P;u.push(new e(G),R),c=b+1,s=b;continue}if(g(P),!k&&(b-s===1||0===b)){if(x.is_prefix){u.push(new o(x.val)),c=b+1,s=b;continue}E(x.val+" is not a valid prefix operator!:"+c)}if(d!==F&&(s=b),x){if(a&&(x.left_assoc&&x.precedence<=a.precedence||!x.left_assoc&&x.precedence<a.precedence)){var z=!1;do{y();var D=C(u);if(D===R)break;z=D?D.left_assoc&&D.precedence<x.precedence:!0}while(!z)}u.push(x),a=C(u)}else{if(d===R)u.push(k);else if(d===F||d===q){s=null;for(var j=!1;!j;){var L=u.pop();if(void 0===L&&E("Unmatched close bracket or parenthesis!"),L===R?j=!0:y(L),L===R&&d===q){var _=C(u);_&&_.name===M||E("Unmatched parenthesis!")}}var Z=C(u);if(Z instanceof e){Z.name===M&&d!==q&&E("Unmatched bracket!");var H=p.callfunction(u.pop().name,f.pop());v=!0,g(H)}}a=C(u)}c=b+1}else b===h-1&&g(r.substring(c,b+1));n=d}for(m=!0;u.length>0;)y();return f[0]},this.ext={log:l,sqrt:a,abs:t,vector:u,parens:r},this.mapped_function=function(){for(var r={},e=this.params,t=0;t<e.length;t++)r[e[t]]=arguments[t];return p.parse(this.body,r)},this.unpack=function(r){if(1===r.power){var e=r.args[0];e.multiplier*=r.multiplier,r=e}return r},this.add=function(r,e){var t=r.group,s=e.group;if(0===r.multiplier)return e;if(0===e.multiplier)return r;if(t===b&&r.baseName===d&&(r=this.unpack(r)),s===b&&r.baseName===d&&(e=this.unpack(e)),t>s)return this.add(e,r);if(h.SAFE&&(r=r.copy(),e=e.copy()),r.value!==e.value||t===w&&r.power!==e.power)if(s===w)if(t===w){if(r.power>e.power){var o=r;r=e,e=o}if(r.value===e.value)r.convert(y),r.attach(e);else if(1===r.power)if(1===e.power){var a;r.distributeMultiplier(),e.distributeMultiplier();for(a in e.symbols)this.add(e.symbols[a],r)}else r.attach(e);else{var n=new i("blank");n.symbols={},n.length=1,n.group=w,n.attach(r),n.attach(e),r=n}}else if(1===e.power){if(1===e.multiplier)e.attach(r);else{for(var a in e.symbols)e.symbols[a].multiplier*=e.multiplier;e.multiplier=1,e.attach(r)}r=e}else r.convert(w),r.attach(e);else r.convert(w),r.attach(e);else if(r.power===e.power&&s!==y||t===v&&r.equals(e))r.multiplier+=e.multiplier,0===r.multiplier&&(r=i(0));else if(s===y)if(t===y)if(1===r.power&&1===e.power){r.distributeMultiplier(),e.distributeMultiplier();for(var a in e.symbols)r.attach(e.symbols[a])}else if(r.power===e.power)r.multiplier+=e.multiplier;else{if(r.power>e.power){var o=r;r=e,e=o}r.convert(w),r.attach(e)}else{if(1===e.multiplier)e.attach(r);else{for(var a in e.symbols)e.symbols[a].multiplier*=e.multiplier;e.multiplier=1,e.attach(r)}r=e}else r.convert(y),r.attach(e);if((r.group===w||r.group===y)&&1===r.length)for(var l in r.symbols){var u=r.symbols[l];u.multiplier*=r.multiplier,r=u}return r},this.subtract=function(r,e){return this.add(r,e.negate())},this.multiply=function(r,e){if(0===r.multiplier||0===e.multiplier)return new i(0);var t=r.group,s=e.group,o=!1;if(t===b&&r.baseName===d&&(r=this.unpack(r)),s===b&&r.baseName===d&&(e=this.unpack(e)),r.isImgSymbol&&e.isImgSymbol){var a=r.power+e.power===0?1:-1;return new i(a*r.multiplier*e.multiplier)}if(t>s)return this.multiply(e,r);if(h.SAFE&&(r=r.copy(),e=e.copy()),D(r.power)&&D(e.power)&&(o=!0,r.invert(),e.invert()),t===c)e.multiplier*=r.multiplier;else if(r.value===e.value){if(t===m&&s===v)e.previousGroup===y?(e.convert(g),e.combine(r)):e.power=p.add(e.power,i(r.power));else if(t===v)if(s===y)e.convert(g),e.combine(r);else{var n=r.previousGroup,l=e.previousGroup;if(n===m||n===c||n===b){var u=r.power,f=e.power;e.group!==v&&(f=new i(f),e=r),e.power=p.add(u,f)}else if(n===y&&n===l)r.keyForGroup(g)!==e.keyForGroup(g)?(e.convert(g),e.combine(r)):e.power=p.add(e.power,r.power);else if(s===v)e.power=p.add(r.power,e.power);else{var M=new i(e.power);r.power=p.add(r.power,M),e=r}}else if(s===y)if(e.distributeMultiplier(),t!==y)if(1===e.power){var x=e.copy();x.symbols={},x.length=0;for(var S in e.symbols){var N=V(e.symbols,S),A=p.multiply(r,N);A.value!==x.value&&(x.group=w),x.attach(A)}e=x}else e.convert(g),e.combine(r);else r.value===e.value?e.power+=r.power:(e.convert(g),e.combine(r));else e.power+=r.power;e.multiplier*=r.multiplier,0===Number(e.power)&&(e=i(e.multiplier))}else if(t===g&&s===g){if(r.distributeExponent(),e.distributeExponent(),1===r.power&&1!==e.power){var k=r;r=e,e=k}if(1===r.power&&1===e.power){e.multiplier*=r.multiplier;for(var S in r.symbols)e.combine(r.symbols[S])}else if(1===e.power)e.attach(r);else{var S=new i("x");S.symbols={},S.group=g,S.combine(r),S.combine(e),e=S}}else s===g?(e.distributeExponent(),e.combine(r)):t===m&&s!==g?(r.convert(g),r.combine(e),e=r):t===g?(r.combine(e),e=r):(e.convert(g),e.combine(r));if(e.group===g&&1===e.length)for(var E in e.symbols){var N=e.symbols[E];N.multiplier*=e.multiplier,e=N}return o&&e.invert(),e},this.divide=function(r,e){return 0===e.multiplier&&E("Division by zero!"),this.multiply(r,e.invert())},this.pow=function(r,e){var t=Number(e);if(1===t)return r;if(0===t)return new i(1);var s=r.group,o=e.group;if(h.SAFE&&(r=r.copy(),e=e.copy()),s!==v&&o===c){var a=e.multiplier;if(1!==a)if(0===a)e.mutiplier=1,r=e;else{var n=Z(a),l=r.multiplier<0,u=Z(r.power),f=Math.abs(a%1)>0;if(s===c){var m=l&&f;m&&(r.multiplier*=-1),r.multiplier=Math.pow(r.multiplier,a),m&&(r=this.multiply(r,new i("i")),0>a&&r.negate())}else{var y=r.multiplier,w=Math.pow(Math.abs(y),a),M=Math.abs(y)/y;if(r.power*=a,r.multiplier=w,l&&!n&&(r.multiplier*=M),f&&l){var S=-r.multiplier;if(u)r.multiplier=1,Z(r.power)||(r=this.symfunction(x,[r])),r=this.multiply(new i("i"),r);else{var N=r.power;r.multiplier/=S,r.power/=N,r=this.symfunction(d,[r]),r.power=N}r.multiplier=S}if(u&&f&&!Z(r.power)){var N=r.power;r.power=1,r=p.symfunction(x,[r]),r.power=N}if(r.group===b&&r.baseName===x){var w=r.args[0],A=r.power*w.power;Z(A)&&(w.power=A,w.multiplier=r.multiplier*Math.pow(w.multiplier,r.power),r=w)}}}if(s===g){var N=r.power;for(var k in r.symbols)r.symbols[k].power*=N;r.power=1}}else{var S,E=r.power;P(E)||(E=new i(E||1)),1!==Math.abs(r.multiplier)&&(S=new i(r.multiplier),S.convert(v),S.power=e.copy(),r.multiplier=1),r.group!==v&&r.convert(v),r.power=this.multiply(E,e),r.power.isOne()&&(r.group=r.previousGroup,delete r.previousGroup,r.power=1),S&&(r=this.multiply(r,S))}return r},this.comma=function(r,e){return r instanceof Array?r.push(e):r=[r,e],r}}function n(r){this.elements=R(r)?r.items.slice(0):r||[]}var l="0.5.4",u=new a,p={},f={},h={suppress_errors:!1,PARSE2NUMBER:!1,SAFE:!1},c=p.N=1,m=p.S=2,v=p.EX=3,b=p.FN=4,y=p.PL=5,g=p.CB=6,w=p.CP=7,d="parens",M="vector",x="abs",S=[],N={},A=[],k=f.isReserved=function(r){return-1!==A.indexOf(r)},E=function(r){if(!h.suppress_errors)throw new Error(r)},U=f.validateName=function(r,e){e=e||"variable";var t=/^[a-z_][a-z\d\_]*$/gi;t.test(r)||E(r+" is not a valid "+e+" name")},C=f.isFraction=function(r){return P(r)?C(r.multiplier):r%1!==0},P=f.isSymbol=function(r){return r instanceof i},R=f.isVector=function(r){return r instanceof n},G=f.isNumericSymbol=function(r){return r.group===c},z=f.isArray=function(r){return r instanceof Array},F=f.isInt=function(r){return r%1===0},D=f.isNegative=function(r){return P(r)&&(r=r.multiplier),0>r},O=(f.isComposite=function(r){return r.group===y||r.group===w},f.inBrackets=function(r){return"("+r+")"}),B=f.customType=function(r){return void 0!==r&&r.custom},j=(f.sameSign=function(r,e){return 0>r==0>e},f.format=function(){var r=[].slice.call(arguments),e=r.shift();return e.replace(/{(\d+)}/g,function(e,t){var i=r[t];return"function"==typeof i?i():i})}),q=f.keys=function(r){var e=[];for(var t in r)e.push(t);return e},I=(f.firstObject=function(r){for(var e in r)break;return r[e]},f.arrayMax=function(r){return Math.max.apply(void 0,r)},f.arrayMin=function(r){return Math.min.apply(void 0,r)},f.round=function(r,e){return e=e||14,Math.round(r*Math.pow(10,e))/Math.pow(10,e)},f.insertArray=function(r,e,t,i){if(i=i===!1?i:!0,z(e)&&i)for(var s=0;s<=e.length+1;s++)I(r,e.pop(),t);else"undefined "==typeof t?r.push(e):r.splice(t,0,e)}),L=f.variables=function(r,e){if(e=e||{c:[],add:function(r){-1===this.c.indexOf(r)&&isNaN(r)&&this.c.push(r)}},P(r)){var t=r.group,i=r.previousGroup;if(t===w||t===g||i===w||i===g)for(var s in r.symbols)L(r.symbols[s],e);else if(t===m||t===y)e.add(r.value);else if(t===v)isNaN(r.value)||e.add(r.value),L(r.power,e);else if(t===b)for(var o=0;o<r.args.length;o++)L(r.args[o],e)}return e.c.sort()},_=f.each=function(r,e){if(z(r))for(var t=r.length,i=0;t>i;i++)e.call(r,i);else for(var s in r)r.hasOwnProperty(s)&&e.call(r,s)},Z=f.even=function(r){return r%2===0},H=(f.evenFraction=function(r){return 1/(r%1)%2===0},f.arrayUnique=function(r){for(var e=r.length,t=[],i=0;e>i;i++)item=r[i],-1===t.indexOf(item)&&t.push(item);return t},f.reserveNames=function(r){var e=function(r){-1===A.indexOf(r)&&A.push(r)};"string"==typeof r?e(r):_(r,function(r){e(r)})}),V=f.remove=function(r,e){var t;return z(r)?t=r.splice(e,1)[0]:(t=r[e],delete r[e]),t},X=f.block=function(r,e,t,i){var s=h[r];h[r]=void 0===t?!0:!!t;var o=e.call(i);return h[r]=s,o},T=(f.arguments2Array=function(r){return[].slice.call(r)},function(r,e,t,i){i=i||0;for(var s,o=t.length,a=0,n=i;o>n;n++){var l=t.charAt(n);if(l===r&&(void 0===s&&(s=n+1),a++),l===e&&(a--,0===a&&void 0!==s)){var u=n;return[t.substring(s,u),s,u]}}return[]}),$=function(r){for(var e in r)r[e]=u.parse(r[e].toString());return r},J={csc:function(r){return 1/Math.sin(r)},sec:function(r){return 1/Math.cos(r)},cot:function(r){return 1/Math.tan(r)},erf:function(r){for(var e=1,t=1,i=1*r,s=1;50>s;s++)e*=s,t*=-1,i+=t*Math.pow(r,2*s+1)/(e*(2*s+1));return 2*i/Math.sqrt(3.14159265358979)},fact:function(r){for(var e=1,t=2;r>=t;t++)e*=t;return e},mod:function(r,e){return r%e},GCD:function(){for(var r=[].slice.call(arguments).map(function(r){return Math.abs(r)}).sort(),e=Math.abs(r.shift()),t=r.length;t-->0;)for(var i=Math.abs(r.shift());;){if(e%=i,0===e){e=i;break}if(i%=e,0===i)break}return e}};H(J),f.text=r,t.getExpression=function(r){"last"!==r&&r||(r=S.length),"first"===r&&(r=1);var e=r-1,i=S[e],s=i?new t(i):i;return s},t.prototype={text:function(){return this.symbol.text("final")},latex:function(){return Q.latex(this.symbol)},valueOf:function(){return this.symbol.valueOf()},evaluate:function(){var r,e=arguments[0],i=1;"string"==typeof e?r="%"===e.charAt(0)?t.getExpression(e.substr(1)).text():e:e instanceof t||P(e)?r=e.text():(r=this.symbol.text(),i--);var s=arguments[i];return new t(X("PARSE2NUMBER",function(){return u.parse(r,$(s))},!0))},buildFunction:function(r){return Y(this.symbol,r)},isNumber:function(){return G(this.symbol)},isInfinity:function(){return 1/0===Math.abs(this.symbol.multiplier)},variables:function(){return L(this.symbol)},toString:function(){return this.symbol.text()},isMonomial:function(){return this.symbol.group===m},isFraction:function(){return C(this.symbol)},isPolynomial:function(){return this.symbol.isPoly()}},i.prototype={coeffs:function(){var r=[];if(this.symbols)for(var e in this.symbols)r.push(this.symbols[e].multiplier);else r.push(this.multiplier);return r},equals:function(e){return this.value===e.value&&r(this.power)===r(e.power)},isPoly:function(){var r=!1;if(this.group===m&&this.power>0||this.group===c)r=!0;else{var e=q(this.symbols).sort(),t=e.length;if(2===t&&"#"===e[0])r=this.symbols[e[1]].isPoly();else if(this.group===y){r=!0;for(var i=0;t>i;i++)e[i]<0&&(r=!1)}}return r},isInverse:function(){return this.group===v?this.power.multiplier<0:this.power<0},copy:function(){var r,e=new i(0),t=["multiplier","value","group","length","previousGroup","isImgSymbol","baseName","args"],s=t.length;if(this.symbols){e.symbols={};for(var o in this.symbols)e.symbols[o]=this.symbols[o].copy()}for(r=0;s>r;r++)void 0!==this[t[r]]&&(e[t[r]]=this[t[r]]);return this.power&&(e.power=P(this.power)?this.power.copy():this.power),e},each:function(r){for(var e in this.symbols)r.call(this,this.symbols[e],e)},valueOf:function(){return this.group===c?this.multiplier:0===this.power?1:0===this.multiplier?0:r(this)},contains:function(r,e){var t=this.group;if(this.symbols){for(var i in this.symbols)if(this.symbols[i].contains(r,e))return!0}else if(t===b||this.previousGroup===b){for(var s=0;s<this.args.length;s++)if(this.args[s].contains(r,e))return!0}else if(t===v)return e&&this.power.contains(r,e)?!0:this.value===r;return this.value===r},negate:function(){return this.multiplier*=-1,(this.group===w||this.group===y)&&this.distributeMultiplier(),this},invert:function(r){return r||(this.multiplier=1/this.multiplier),P(this.power)?this.power.negate():this.power&&(this.power*=-1),this},distributeMultiplier:function(){if(this.symbols&&1===this.power&&this.group!==g){for(var r in this.symbols){var e=this.symbols[r];e.multiplier*=this.multiplier,e.distributeMultiplier()}this.multiplier=1}return this},distributeExponent:function(){if(1!==this.power){var r=this.power;for(var e in this.symbols){var t=this.symbols[e];t.group===v?t.power=u.multiply(t.power,new i(r)):this.symbols[e].power*=r}this.power=1}return this},convert:function(r){if(r>b){var e=this.copy();this.symbols={},r===g?e.multiplier=1:this.multiplier=1,this.group===b&&(e.args=this.args,delete this.args,delete this.baseName),this.isImgSymbol&&delete this.isImgSymbol,this.power=1,this.symbols[e.keyForGroup(r)]=e,this.group=r,this.length=1}else if(r===v)(this.group!==c||1!==Math.abs(this.multiplier))&&(this.previousGroup=this.group,this.group===c&&(this.value=this.multiplier,this.multiplier=1),this.group=v);else if(r===c){for(var t in this)this.hasOwnProperty(t)&&"value"!==t&&"multiplier"!==t&&delete this[t];this.value="#",this.group=c}},insert:function(r,e){if(P(r)||E("Object "+r+" is not of type Symbol!"),this.symbols){var t=this.group;if(t>b){var i=r.keyForGroup(t),s=this.symbols[i];if("add"===e){var o=i;s?(this.symbols[o]=u.add(s,r),0===this.symbols[o].multiplier&&(delete this.symbols[o],this.length--,0===this.length&&(this.convert(c),this.multiplier=0))):(this.symbols[i]=r,this.length++)}else if(s&&(r=u.multiply(V(this.symbols,i),r),0===this.length&&this.convert(c),this.length--),this.multiplier*=r.multiplier,r.multiplier=1,1!==Math.abs(r.valueOf())){if(1!==this.power){var a=this.copy();a.multiplier=1,this.power=1,this.symbols={};var n=a.keyForGroup(g);this.symbols[n]=a}this.symbols[i]=r,this.length++}(this.group===w||this.group===g)&&this.updateHash()}}},attach:function(r){this.insert(r,"add")},combine:function(r){this.insert(r,"multiply")},updateHash:function(){if(this.group===b){for(var e="",t=this.args,i=this.baseName===d,s=0;s<t.length;s++)e+=(0===s?"":",")+r(t[s]);var o=i?"":this.baseName;this.value=o+(i?e:O(e))}else this.group!==m&&this.group!==y&&(this.value=r(this,"hash"))},keyForGroup:function(e){var t=this.group;return t===c?this.value:t===m?e===y?this.power:this.value:t===b?e===y?this.power:r(this,"hash"):t===y?e===g?r(this,"hash"):e===w?1===this.power?this.value:O(r(this,"hash"))+"^"+this.power:this.value:t===w?e===w?r(this,"hash"):e===y?this.power:this.value:t===g?e===y?this.power:r(this,"hash"):t===v?e===y?r(this.power):r(this,"hash"):void 0},collectSymbols:function(r){var e=[];for(var t in this.symbols){var i=this.symbols[t];e.push(r?r(i):i)}return e.sort()},text:function(){return r(this)},isOne:function(){return this.group===c?1===this.multiplier:0===this.power},getDenom:function(){if(this.group===g)for(var r in this.symbols)if(this.symbols[r].power<0)return this.symbols[r]},toString:function(){return this.text()}},s.prototype={toString:function(){return this.val}},o.prototype={resolve:function(r){return"-"===this.val?r.negate():r}};var K={convert:function(r){var e;if(0===r)e=[0,1];else if(1e-6>r||r>1e20){var t=this.quickConversion(Number(r));if(t[1]<=1e20){var i=Math.abs(r),s=r/i;e=this.fullConversion(i.toFixed((t[1]+"").length-1)),e[0]=e[0]*s}else e=t}else e=this.fullConversion(r);return e},quickConversion:function(r){var e=(r.toExponential()+"").split("e"),t=e[0].split(".")[1],i=t?t.length:0;return[Math.pow(10,i)*e[0],Math.pow(10,Math.abs(e[1])+i)]},fullConversion:function(r){for(var e=!1,t=0,i=1,s=1,o=0,a=0,n=r,l=1e-13;!e;){a++,a>1e4&&(e=!0);var u=parseInt(n),p=t+u*s,f=i+u*o,h=n-u;l>h&&(e=!0),n=1/h,t=s,i=o,s=p,o=f,(Math.abs(p/f-r)<l||a>30)&&(e=!0)}return[p,f]}},Q={space:"~",latex:function(r,e,t,i){e=e||!1,t=t||r.group;{var s,o="";this.inBraces}if(P(r))switch(t){case c:if(s=r.multiplier,e&&(s=Math.abs(s)),F(s))o=s;else if(1/0===Math.abs(s))o="\\infty",s===-1/0&&(o="-"+o);else{var a=K.convert(s);o=this.fraction(a)}break;case m:o=this.renderSymbolLatex(r,void 0,e);break;case b:var n=r.baseName;n===d?n="":(n in Math||n in J)&&(n="\\"+n);var l=r.args.slice(0).map(function(r){return Q.latex(r)});s="\\abs"===n?"\\left|"+l+"\\right|":n+this.inBrackets(l),o=this.renderSymbolLatex(r,s,e);break;case y:var s=this.renderSubSymbolsLatex(r,function(r,e){return r.power<e.power},void 0,e);o=this.renderSymbolLatex(r,s,e,r.group===v);break;case w:s=this.renderSubSymbolsLatex(r,function(r,e){return r.group<e.group},void 0,e),o=this.renderSymbolLatex(r,s,e,r.group===v);break;case g:s=this.renderSubSymbolsLatex(r,function(r,e){return r.group<e.group},!0,e),o=this.renderSymbolLatex(r,s,e);break;case v:var u=r.previousGroup;u===c&&(u=m),o=this.latex(r,e,u)}else if(z(r))for(var p=r.length,f=0;p>f;f++)o="\\left["+r.map(function(r){return Q.latex(r)}).join(" ,")+"\\right]";else o="function"==typeof r.latex?r.latex():r;return i&&(o=this.inBrackets(o)),o},renderSubSymbolsLatex:function(r,e,t,i){function s(e){for(var s,o=e.length,a="",s=0;o>s;s++){var n,l=e[s];n=l.multiplier<0?"-":t?"":"+",i=i||s>0;var p=u.latex(l,i,void 0,r.group===g&&(l.group===y||l.group===w));s>0&&(p=n+p),a+=p}return a}var o,a=r.collectSymbols().sort(e),n=a.length,l=[],u=this,p=r.group,f=.5===Math.abs(r.power);for(o=0;n>o;o++){var h=a[o];h.isInverse()&&p===g&&(l.push(V(a,o).copy().invert()),o--,n--)}e&&(a.sort(e),l.sort(e));var c=s(a),l=s(l);return(p===w||p===y)&&(c&&!l&&1!==Math.abs(r.multiplier)||Math.abs(1!==r.power))&&(f||(c=Q.inBrackets(c))),l&&!c&&(c=1),l?j("\\frac{{0}}{{1}}",c,l):c},renderSymbolLatex:function(r,e,t,i){if(r.group===c)return this.latex(r,t);e=e||r.value;var s=K.convert(r.multiplier),o=r.power||"",a=r.multiplier<0?"-":"",n=.5===o,l=o===-.5;if(t&&(a=""),s[0]=Math.abs(s[0]),P(o))o=this.latex(o,!0);else if(1===Math.abs(o)||n||l)o="";else{var u=K.convert(o);1===u[1]&&u.pop(),r.power<0&&(u[0]=Math.abs(u[0])),o=this.fraction(u)}1===s[1]&&s.pop();var p=D(r.power)?1:0;if(1===s[p])s[p]=e;else if(/^\\frac/.test(e))for(var f=4,h=0;2>h;h++){var m=s[h],v=1!==m&&void 0!==m?m+this.space:"",b=T("{","}",e,f);s[h]=v+b[0],f=b[2]+1}else{var y=s[p]?s[p]+this.space:"";l&&(e="\\sqrt"+this.inBraces(e)),s[p]=y+e}o&&(s[p]=this[i?"inBrackets":"inBraces"](s[p]),n||(s[p]+="^"+this.inBraces(o))),e=this.fraction(s);var g=a+e;return n&&(g="\\sqrt"+this.inBraces(g)),g},fraction:function(r){return 1===r.length?r[0]:"\\frac"+this.inBraces(r[0])+this.inBraces(r[1])},inBraces:function(r,e){return e=void 0===e?"":"$"+e,"{"+r+e+"}"},inBrackets:function(r){return"\\left("+r+"\\right)"},write2Fraction:function(r,e,t){return r.replace("$1",e).replace("$2",t)}};n.prototype.custom=!0;var W=function(){H(u.constants),H(u.functions)},Y=f.build=function(e,t){var i=L(e),s=function(e,t){t=t||[];var i=[],o=e.group,a="",n=function(r){var i=r===g?"*":"+",o=[];for(var a in e.symbols)o.push(s(e.symbols[a],t)[0]);var n=o.join(i);return n?O(n):n},l=function(r){var i;return r in Math?i="Math."+r:(t.push("var "+r+" = "+u.Math2[r].toString()+"; "),i=r),i+=O(e.args.map(function(r){return s(r,t)[0]}).join(","))};o===c?i.push(e.multiplier):-1===e.multiplier?a="-":1!==e.multiplier&&i.push(e.multiplier);var p=null;if(o===m)p=e.value;else if(o===b)p=l(e.baseName);else if(o===v){var f=e.previousGroup;p=f===c||f===m?e.value:f===b?l(e.baseName):n(e.previousGroup)}else p=n(e.group);return void 0!==e.power&&1!==e.power&&(p="Math.pow"+O(p+","+r(e.power))),p&&i.push(a+p),[i.join("*"),t.join("").replace(/\n+\s+/g," ")]};if(t){i.length!==t.length&&E("Argument array contains wrong number of arguments");for(var o=0;o<i.length;o++){var a=i[o];-1===t.indexOf(a)&&E(a+" not found in argument array")}i=t}var n=s(e);return new Function(i,n[1]+" return "+n[0]+";")};W();var re={};re.groups=p,re.Symbol=i,re.Expression=t,re.Vector=n,re.Parser=a,re.Fraction=K,re.Math2=J,re.Latex=Q,re.Utils=f,re.PARSER=u,re.PARENTHESIS=d,re.Settings=h,re.VARS=N;var ee=function(r,e,i,s){r instanceof t&&(r=r.toString());var o=z(i),a="expand",n=o?-1!==i.indexOf("numer"):"numer"===i;(o?-1!==i.indexOf(a):i===a)&&"undefined"!=typeof re.Algebra.expand&&(r=j("{0}({1})",a,r));var l=X("PARSE2NUMBER",function(){return u.parse(r,$(e))},n||h.PARSE2NUMBER);return s?S[s-1]=l:S.push(l),new t(l)};return ee.version=function(){return l},ee.setConstant=function(r,e){return U(r),k(r)||("delete"===e?delete u.constants[r]:(isNaN(e)&&E("Constant must be a number!"),u.constants[r]=e)),this},ee.setFunction=function(r,e,t){return U(r),k(r)?!1:(e=e||L(u.parse(t)),u.functions[r]=[u.mapped_function,e.length,{name:r,params:e,body:t}],!0)},ee.getCore=function(){return re},ee.getExpression=ee.getEquation=t.getExpression,ee.reserved=function(r){return r?A:A.join(", ")},ee.clear=function(r,e){if("all"===r)S=[];else if("last"===r)S.pop();else if("first"===r)S.shift();else{var t=r?r-1:S.length;e===!0?S[t]=void 0:V(S,t)}return this},ee.expressions=ee.equations=function(e,t){for(var i=e?{}:[],s=0;s<S.length;s++){var o=t?Q.latex(S[s]):r(S[s]);e?i[s+1]=o:i.push(o)}return i},ee.register=function(r){var e=this.getCore();if(z(r))for(var t=0;t<r.length;t++)r&&this.register(r[t]);else if(r){var i=r.parent,s=r.build.call(e);i&&(e[i]||(e[r.parent]={}),e[i][r.name]=s),r.visible&&(u.functions[r.name]=[s,r.numargs])}},ee.validateName=U,ee.supported=function(){return q(u.functions)},ee.numEquations=ee.numExpressions=function(){return S.length},ee.setVar=function(r,e){return U(r),"delete"===e?delete N[r]:N[r]=u.parse(e),this},ee.set=function(r,e){var t=["SAFE"];-1!==t.indexOf(r)&&E("Cannot modify setting: "+r),h[r]=e},ee}();!function(){var r=nerdamer.getCore(),e=r.PARSER,t=r.Utils.keys,s=(r.Utils.text,r.Utils.remove,r.Symbol),o=r.groups.S,a=r.Utils.round,n=r.Utils.isInt,l=r.Math2,u=r.Utils.variables,p=r.Utils.isComposite,f=r.Utils.isSymbol,h=r.groups.PL,c=r.groups.CP,m=r.Algebra={proots:function(e,i){function n(){function s(r,e,t,i,s,o){s[0]=o.b=i[0],s[1]=o.a=-(e*o.b)+i[1];for(var a=2;r>a;a++)s[a]=-(e*o.a+t*o.b)+i[a],o.b=o.a,o.a=s[a]}function n(r,e,t,i,o,a,n,l,u){var p=new Object,f=3;return p.b=p.a=0,s(e,n,l,a,u,p),o.c=p.a,o.d=p.b,Math.abs(o.c)<=100*r*Math.abs(a[e-1])&&Math.abs(o.d)<=100*r*Math.abs(a[e-2])?f:(o.h=l*i,Math.abs(o.d)>=Math.abs(o.c)?(f=2,o.e=t/o.d,o.f=o.c/o.d,o.g=n*i,o.a3=o.e*(o.g+t)+o.h*(i/o.d),o.a1=-t+o.f*i,o.a7=o.h+(o.f+n)*t):(f=1,o.e=t/o.c,o.f=o.d/o.c,o.g=o.e*n,o.a3=o.e*t+(o.g+o.h/o.c)*i,o.a1=-(t*(o.d/o.c))+i,o.a7=o.g*o.d+o.h*o.f+t),f)}function l(r,e,t,i,s,o,a,n,l){var u;if(3!=t)if(u=1==t?s:i,Math.abs(o.a1)>10*r*Math.abs(u)){o.a7/=o.a1,o.a3/=o.a1,a[0]=l[0],a[1]=-(l[0]*o.a7)+l[1];for(var p=2;e>p;p++)a[p]=-(l[p-1]*o.a7)+n[p-2]*o.a3+l[p]}else{a[0]=0,a[1]=-(l[0]*o.a7);for(var p=2;e>p;p++)a[p]=-(l[p-1]*o.a7)+n[p-2]*o.a3}else{a[1]=a[0]=0;for(var p=2;e>p;p++)a[p]=n[p-2]}}function u(r,e,t,i,s,o,a,n,l,u,p,f,h,c,m,v,b){var y,g,w,d,M,x,S,N,A;e.b=e.a=0,3!=r&&(2!=r?(y=t+h*a+f*u,g=n+(h+c*u)*l):(y=(t+p)*u+f,g=(u+h)*n+c*l),w=-(m[v-1]/b[v]),d=-(m[v-2]+w*b[v-1])/b[v],M=c*d*i,x=w*o,S=w*w*s,N=-(x+S)+M,A=-N+g+w*y,0!=A&&(e.a=-((h*(S+x)+c*(w*i+d*o))/A)+h,e.b=c*(1+N/A)))}function p(r,e,t,i){var s,o,a;return i.sr=i.si=i.lr=i.li=0,0==r?void(i.sr=0!=e?-(t/e):i.sr):0==t?void(i.lr=-(e/r)):(s=e/2,Math.abs(s)<Math.abs(t)?(a=t>=0?r:-r,a=-a+s*(s/Math.abs(t)),o=Math.sqrt(Math.abs(a))*Math.sqrt(Math.abs(t))):(a=-(r/s*(t/s))+1,o=Math.sqrt(Math.abs(a))*Math.abs(s)),void(a>=0?(o=s>=0?-o:o,i.lr=(-s+o)/r,i.sr=0!=i.lr?t/i.lr/r:i.sr):(i.lr=i.sr=-(s/r),i.si=Math.abs(o/r),i.li=-i.si)))}function f(r,e,t,i,o,a,f,h,c,m,v,b){var y,g,w,d,M,x,S,N,A,k,E,U,C=new Object,P=0,R=0;t.NZ=0,x=i,N=o;do{if(C.li=C.lr=C.si=C.sr=0,p(1,x,N,C),t.szr=C.sr,t.szi=C.si,t.lzr=C.lr,t.lzi=C.li,Math.abs(Math.abs(t.szr)-Math.abs(t.lzr))>.01*Math.abs(t.lzr))break;for(s(f,x,N,c,a,h),g=Math.abs(-(t.szr*h.b)+h.a)+Math.abs(t.szi*h.b),k=Math.sqrt(Math.abs(N)),y=2*Math.abs(a[0]),M=-(t.szr*h.b),E=1;e>E;E++)y=y*k+Math.abs(a[E]);if(y=y*k+Math.abs(M+h.a),y=(9*y+2*Math.abs(M)-7*(Math.abs(h.a+M)+k*Math.abs(h.b)))*r,20*y>=g){t.NZ=2;break}if(P++,P>20)break;if(P>=2&&.01>=d&&g>=w&&!R){for(d=Math.sqrt(r>d?r:d),x-=x*d,N+=N*d,s(f,x,N,c,a,h),E=0;5>E;E++)U=n(r,e,h.a,h.b,v,b,x,N,m),l(r,e,U,h.a,h.b,v,b,m,a);R=1,P=0}w=g,U=n(r,e,h.a,h.b,v,b,x,N,m),l(r,e,U,h.a,h.b,v,b,m,a),U=n(r,e,h.a,h.b,v,b,x,N,m),u(U,h,h.a,v.a1,v.a3,v.a7,h.b,v.c,v.d,v.f,v.g,v.h,x,N,b,e,c),S=h.a,A=h.b,0!=A&&(d=Math.abs((-N+A)/A),x=S,N=A)}while(0!=A)}function h(r,e,t,i,s,o,a,n,l){var u,p,f,h,c,m,v,b,y,g,w,d=i-1;for(e.NZ=w=y=0,v=t.a;;){for(m=s[0],a[0]=m,g=1;o>g;g++)a[g]=m=m*v+s[g];for(f=Math.abs(m),h=Math.abs(v),u=.5*Math.abs(a[0]),g=1;o>g;g++)u=u*h+Math.abs(a[g]);if(20*r*(2*u-f)>=f){e.NZ=1,e.szr=v,e.szi=0;break}if(w++,w>10)break;if(w>=2&&Math.abs(b)<=.001*Math.abs(-b+v)&&f>c){y=1,e.a=v;break}for(c=f,l[0]=p=n[0],g=1;i>g;g++)l[g]=p=p*v+n[g];if(Math.abs(p)>10*Math.abs(n[d])*r)for(b=-(m/p),n[0]=a[0],g=1;i>g;g++)n[g]=b*l[g-1]+a[g];else for(n[0]=0,g=1;i>g;g++)n[g]=l[g-1];for(p=n[0],g=1;i>g;g++)p=p*v+n[g];b=Math.abs(p)>10*Math.abs(n[d])*r?-(m/p):0,v+=b}return y}function c(r,e,t,i,o,a,p,c,m,v,b,y){var g,w,d,M,x,S,N,A,k,E,U,C,P,R,G,z,F,D,O,B,j,q,I,L,_,Z=new Object,H=new Object,V=new Array(e),X=new Array(e),T=1;for(y.NZ=0,M=d=.25,x=i,A=o,Z.b=Z.a=0,s(m,b,o,c,v,Z),g=Z.a,w=Z.b,H.h=H.g=H.f=H.e=H.d=H.c=H.a7=H.a3=H.a1=0,I=n(r,p,g,w,H,a,b,o,V),B=0;t>B;B++){if(D=1,l(r,p,I,g,w,H,a,V,v),I=n(r,p,g,w,H,a,b,o,V),u(I,Z,g,H.a1,H.a3,H.a7,w,H.c,H.d,H.f,H.g,H.h,b,o,a,p,c),G=Z.a,F=z=Z.b,E=0!=a[p-1]?-(c[p]/a[p-1]):0,U=P=1,0!=B&&3!=I&&(P=0!=F?Math.abs((F-A)/F):P,U=0!=E?Math.abs((E-x)/E):U,R=N>P?P*N:1,C=S>U?U*S:1,L=M>R?1:0,j=d>C?1:0,j||L)){for(O=0;p>O;O++)X[O]=a[O];for(k=E,q=_=0;;){if(D&&0==(D=0)&&j&&(!L||R>C));else{if(f(r,p,y,G,z,v,m,Z,c,V,H,a),g=Z.a,w=Z.b,y.NZ>0)return;if(T=_=1,M*=.25,q||!j)T=0;else for(O=0;p>O;O++)a[O]=X[O]}if(0!=T){if(Z.a=k,T=h(r,y,Z,p,c,m,v,a,V),k=Z.a,y.NZ>0)return;if(q=1,d*=.25,0!=T){G=-(k+k),z=k*k;continue}}for(O=0;p>O;O++)a[O]=X[O];if(!L||_)break}s(m,b,o,c,v,Z),g=Z.a,w=Z.b,I=n(r,p,g,w,H,a,b,o,V)}A=F,x=E,N=P,S=U}}function m(r,e,t,i){var s,o,a,n,l,u,f,h,m,v,b,y,g,w,d,M,x,S,N,A,k,E,U,C,P=r.Degree,R=.017453292519943295,G=Math.LN2,z=r.Degree+1,F=new Array(z),D=new Array(z),O=new Array(z),B=new Array(z),j=new Object,q=new Object;y=1;do o=y,y/=2,g=1+y;while(g>1);var I=Number.MIN_VALUE/o,L=Math.cos(94*R),_=Math.sin(94*R),Z=Math.sqrt(.5),H=-Z;for(q.NZ=N=0,q.szr=q.szi=q.lzr=q.lzi=0;0==e[P];)t[N]=i[N]=0,P--,N++;for(U=P+1;P>=1;){if(2>=P){2>P?(t[r.Degree-1]=-(e[1]/e[0]),i[r.Degree-1]=0):(j.li=j.lr=j.si=j.sr=0,p(e[0],e[1],e[2],j),t[r.Degree-2]=j.sr,i[r.Degree-2]=j.si,t[r.Degree-1]=j.lr,i[r.Degree-1]=j.li);break}for(f=0,h=Number.MAX_VALUE,V=0;U>V;V++)v=Math.abs(e[V]),v>f&&(f=v),0!=v&&h>v&&(h=v);if(m=I/h,(1>=m&&f>=10||m>1&&Number.MAX_VALUE/m>=f)&&(m=0==m?Number.MIN_VALUE:m,k=Math.floor(Math.log(m)/G+.5),l=Math.pow(2,k),1!=l))for(V=0;U>V;V++)e[V]*=l;for(var V=0;U>V;V++)D[V]=Math.abs(e[V]);D[P]=-D[P],E=P-1,v=Math.exp((Math.log(-D[P])-Math.log(D[0]))/P),0!=D[E]&&(b=-D[P]/D[E],v=v>b?b:v),b=v;
do{v=b,b=.1*v,u=D[0];for(var V=1;U>V;V++)u=u*b+D[V]}while(u>0);n=v;do{a=u=D[0];for(var V=1;P>V;V++)u=v*u+D[V],a=v*a+u;u=v*u+D[P],n=u/a,v-=n}while(Math.abs(n/v)>.005);s=v;for(var V=1;P>V;V++)F[V]=(P-V)*e[V]/P;for(F[0]=e[0],y=e[P],g=e[E],C=0==F[E]?1:0,A=0;5>A;A++)if(w=F[E],C){for(var V=0;E>V;V++)N=E-V,F[N]=F[N-1];F[0]=0,C=0==F[E]?1:0}else{M=-y/w;for(var V=0;E>V;V++)N=E-V,F[N]=M*F[N-1]+e[N];F[0]=e[0],C=Math.abs(F[E])<=Math.abs(g)*o*10?1:0}for(var V=0;P>V;V++)B[V]=F[V];for(A=1;20>=A;A++){if(S=-(_*H)+L*Z,H=_*Z+L*H,Z=S,d=s*Z,x=-(2*d),c(o,z,20*A,d,s,F,P,e,U,O,x,q),0!=q.NZ){N=r.Degree-P,t[N]=q.szr,i[N]=q.szi,U-=q.NZ,P=U-1;for(var V=0;U>V;V++)e[V]=O[V];1!=q.NZ&&(t[N+1]=q.lzr,i[N+1]=q.lzi);break}for(var V=0;P>V;V++)F[V]=B[V]}if(A>20){r.Degree-=P;break}}}for(var v=100,b=t(e.symbols).sort().pop(),y=e.group===r.groups.PL?e.symbols:e.symbols[b],g=y.group,w=g===o?[y.power]:t(y.symbols),d=[],M=r.Utils.arrayMax(w),x=1;M>=x;x++){var S=0;-1!==w.indexOf(x+"")&&(S=g===o?y.multiplier:y.symbols[x].multiplier),d.unshift(S)}d.push(e.symbols["#"].multiplier);var N=d.slice(0);if(d.unshift(M),M>v)throw new Error("This utility accepts polynomials of degree up to "+v+". ");var A=[],k={};for(k.Degree=M,x=0;M>x;x++)A.push(0);var E=A.slice(0);m(k,N,E,A);var U=A.length;for(x=0;U>x;x++){var C=a(A[x],i+8),P=a(E[x],i);P=i-String(P).length>2?P:E[x];var R=0>C?"-":"";0===P&&(P=""),0===C&&(C=""),C=1===Math.abs(C)?R+"i":C?C+"*i":"";var G=P&&C?P+"+"+C:P+C;E[x]=G.replace(/\+\-/g,"-")}return E}i=i||7;var l=0;if(e instanceof s&&e.isPoly()){if(e.group===r.groups.S)return[0];if(e.group===r.groups.PL){{var u=t(e.symbols),p=r.Utils.arrayMin(u);r.PARSER.parse(e.value+"^"+p)}l=p,e=r.PARSER.divide(e,r.PARSER.parse(e.value+"^"+p))}for(var f=n(),h=0;l>h;h++)f.unshift(0);return f}throw new Error("Cannot calculate roots. Symbol must be a polynomial!")},factor:function(i){var o=i,a=i.group,p=function(r){return r===h||r===c};if(p(a)){for(var m in i.symbols)i.symbols[m].distributeMultiplier();var v=l.GCD.apply(void 0,i.coeffs()),b=function(r){for(var e in r.symbols){var t=r.symbols[e];p(t.group)?b(t):t.multiplier/=v}};if(b(i),i.multiplier*=v,a===h){var y=t(i.symbols),g=r.Utils.arrayMin(y),w=e.parse(i.value+"^"+g),d=new r.Symbol(0);for(var m in i.symbols)d=e.add(d,e.divide(i.symbols[m],w.copy()));d=e.symfunction(r.PARENTHESIS,[d]),d.power*=i.power,d.multiplier*=i.multiplier,w.power*=i.power,o=e.multiply(w,d)}else if(a===c)try{for(var M=r.Utils.arrayUnique(r.Algebra.proots(i)),x=!0,S=0;S<M.length;S++)n(M[S])||(x=!1);var N=new s(1);x&&(M.map(function(t){N=e.multiply(N,e.symfunction(r.PARENTHESIS,[e.subtract(new s(u(i)[0]),new s(t))]))}),N.multiplier*=i.multiplier,o=N)}catch(A){try{for(var k=i.collectSymbols(),E=i.length,U={},S=0;E>S;S++)for(var C=k[S],P=vars.length,R=0;P>R;R++){var G=vars[R],z=C.value===G?C:C.symbols[G],F=U[G];if(f(z.power))throw new Error("Cannot factor symbol. Exiting");if(F){F[0]++;var D=z.power;D<F[1]&&(F[1]=D)}else U[G]=[1,z.power]}var w=[];for(var m in U)F=U[m],F[0]===E&&w.push(m+"^"+F[1]);w=e.parse(w.join("*"));for(m in i.symbols)i.symbols[m]=e.divide(i.symbols[m],w.copy());o=e.multiply(e.parse(i.text()),w)}catch(A){}}}return o.group===r.groups.FN&&o.updateHash(),o},expand:function(t){function i(r){if(!p(r))return r;var e=r.power,t=Math.abs(e);if(n(e)&&1!==t){var i=e/t,s=r.multiplier;t--,r.power=1,r.multiplier=1;for(var a=r.copy(),l=0;t>l;l++)a=o(a,l===t?r:r.copy());a.multiplier=s,a.power&&(a.power*=i),r=a}return r}function o(t,i){var a=new s(0),n=p(t),l=p(i);if(!n&&l||t.power<0&&!(i.power<0)){var u=i;i=t,t=u,u=l,l=n,n=u}var a=new s(0),f=r.Utils.sameSign(t.power,i.power);if(n)for(var h in t.symbols){var c=t.symbols[h];if(l&&f)for(var m in i.symbols){var v,b=i.symbols[m];v=p(c)||p(b)?o(c.copy(),b.copy()):e.multiply(c.copy(),b.copy()),a=e.add(a,v)}else a=e.add(a,e.multiply(c.copy(),i.copy()))}else a=e.multiply(t,i);return a}var a=p(t);if(t=i(t),t.symbols&&t.group!==r.groups.EX){for(var l=t.collectSymbols(),u=l.length,f=0;u-1>f;f++){var h=i(l.pop()),c=i(l.pop()),v=a?e.add(h,c.copy()):o(h,c);l.push(v)}var b=l[0];b&&(b.multiplier*=t.multiplier,b.group!==r.groups.N&&(b.distributeMultiplier(),v.power*=t.power),t=b)}else t.args?(t.args[0]=m.expand(t.args[0]),t.group===r.groups.FN&&t.updateHash()):t.group===r.groups.EX&&(t.power=m.expand(t.power));return t},poly2Arrays:function(e,t){var i=this;if(!e.isPoly())throw new Error("Polynomial Expected! Received "+r.Utils.text(e));var s=[];if(1!==Math.abs(e.power)&&(e=r.Algebra.expand(e)),e.group===r.groups.N)s.push([e.multiplier,0]);else if(e.group===r.groups.S)s.push([e.multiplier,e.power]);else for(var o in e.symbols){if(r.Utils.isSymbol(n))throw new Error("power cannot be a Symbol");var a=e.symbols[o],n=a.power;a.symbols?s.push.apply(s,i.poly2Arrays(a)):s.push([a.multiplier,n||0])}return t&&(s=s.sort(function(r,e){return r[1]>e[1]})),s},zeroPolynomial:function(r){return 0===r[0]&&0===r[1]},polyArrayCopy:function(r){return r.map(function(r){return r.slice(0)})},polyfill:function(r){0!==r[0][1]&&r.unshift([0,0]);for(var e,t=r.length-1,i=[],s=0;t>s;s++){e=r.pop(),i.push(e);for(var o=e[1],a=r[t-(s+1)][1],n=o-a-1,l=0;n>l;l++)i.push([0,o-(l+1)])}return i.push(r[0]),i},polyArrayDiv:function(r,e){var t=e[0][1],i=e[0][0],s=e.length,o=0,a=[];do{var n=r[o][1],l=r[o][0]/i,u=n-t;if(0>u)break;a.push([l,u]);for(var p=0;s>p;p++){var f=o+p,h=e[p];r[f][0]-=h[0]*l}o++}while(u>0);var c=[],m=r.length;for(p=0;m>p;p++){var v=r[p];0!==v[0]&&c.push(v)}return void 0===a[0]&&a.push([0,0]),void 0===c[0]&&c.push([0,0]),[a,c]},polyArrayCoeffs:function(r,e){for(var t=[],i=r.length,s=0;i>s;s++){var o=r[s][0];(0!==o||e)&&t.push(o)}return t},polydiv:function(t,i){if(t.group===r.groups.CB){for(var s,o,a=t.collectSymbols(),n=a.length,l=r.Utils.variables(t)[0],u=0;n>u;u++)if(a[u].power<0){o=r.Utils.remove(a,u);break}try{if(n-->2){for(u=0;n>u;u++)a[u]="("+a[u].text()+")";s=e.parse(a.join("*"))}else s=a[0];var p;p=o.group===r.groups.S&&o.value===l?[[t.multiplier,t.power]]:r.Algebra.poly2Arrays(o,!0);var f=r.Algebra.poly2Arrays(s,!0);f=r.Algebra.polyfill(f),p=r.Algebra.polyfill(p);var h=r.Algebra.polyArrayDiv(f,p),c=h[0],m=h[1];if(!i){var v=function(r){return r.map(function(r){return r[0]+"*"+l+"^"+r[1]}).join("+")};m=e.parse(v(m)),c=e.parse(v(c))}return[c,m]}catch(b){}}return t},polyArrayGCD:function(e,t){var s=e[0][1],o=t[0][1];if(s===o&&1===e.length&&1===t.length)return[[r.Math2.GCD(e[0][0],t[0][0]),s]];var a=r.Math2.GCD.apply(void 0,m.polyArrayCoeffs(e).concat(m.polyArrayCoeffs(t)));if(1!==a){var n=function(r){return r[0]=r[0]/a,r};e=e.map(n),t=t.map(n)}if(o>s){var l=t;t=e,e=l}var u,p,f=e,h=t;do p=m.polyArrayDiv(m.polyArrayCopy(f),m.polyArrayCopy(h)),u=p[1],f=h,h=u;while(0!==u[0][0]||0!==u[0][1]);var c=f,v=c.length,b=r.Math2.GCD.apply(void 0,m.polyArrayCoeffs(c))/a;if(1!==b)for(i=0;i<v;i++)c[i][0]/=b;return c},polyGCD:function(){for(var e=r.Algebra.polyArrayGCD,t=arguments.length,i=0,s=m.poly2Arrays(arguments[i]);t>++i;){var o=m.poly2Arrays(arguments[i]);s=e(m.polyfill(s),o=m.polyfill(o))}return s}};nerdamer.register([{name:"proots",visible:!0,numargs:[1,2],build:function(){return m.proots}},{name:"factor",visible:!0,numargs:1,build:function(){return m.factor}},{name:"expand",visible:!0,numargs:1,warnings:"unoptimized, slow",build:function(){return m.expand}},{name:"polyGCD",visible:!0,numargs:-1,build:function(){return m.polyGCD}}])}(),function(){var r=nerdamer.getCore(),e=r.PARSER,t=r.Utils.isSymbol,i=r.groups.FN,s=r.Symbol,o=r.Utils.text,a=r.Utils.inBrackets,n=r.groups.N,l=r.groups.S,i=r.groups.FN,u=r.groups.PL,p=r.groups.CP,f=r.groups.CB,h=r.groups.EX,c=r.Calculus={version:"1.0.0",sum:function(t,i,a,n){if(i.group!==r.groups.S)throw new Error("Index must be symbol. "+o(i)+" provided");i=i.value;var l;if(r.Utils.isNumericSymbol(a)&&r.Utils.isNumericSymbol(n)){a=a.multiplier,n=n.multiplier;var u=r.Utils.variables(t);if(1===u.length&&i===u[0]){var p=r.Utils.build(t);l=0;for(var f=a;n>=f;f++)l+=p.call(void 0,f)}else for(var p=t.text(),h={"~":!0},l=new r.Symbol(0),f=a;n>=f;f++)h[i]=new s(f),l=e.add(l,e.parse(p,h))}else l=e.symfunction("sum",arguments);return l},diff:function(m,v){function b(r){return(r.value===d||r.contains(d,!0))&&(r.multiplier*=r.power,r.power-=1,0===r.power&&(r=s(r.multiplier))),r}function y(r){var m,v,M,x=r.group;if(x===n||x===l&&r.value!==d)r=s(0);else if(x===l)r=b(r);else{if(x===f){var S=r.multiplier;r.multiplier=1;var N=e.multiply(w(r),b(r.copy()));return N.multiplier*=S,N}if(x===i&&1===r.power)switch(r.baseName){case"log":M=r.copy(),r=r.args[0].copy(),t(r.power)?r.power=e.multiply(r.power,s(-1)):r.power*=-1,r.multiplier=M.multiplier/r.multiplier;break;case"cos":r.baseName="sin",r.multiplier*=-1;break;case"sin":r.baseName="cos";break;case"tan":r.baseName="sec",r.power=2;break;case"sec":r=g(r,"tan");break;case"csc":r=g(r,"-cot");break;case"cot":r.baseName="csc",r.multiplier*=-1,r.power=2;break;case"asin":r=e.parse("(sqrt(1-("+o(r.args[0])+")^2))^(-1)");break;case"acos":r=e.parse("-(sqrt(1-("+o(r.args[0])+")^2))^(-1)");break;case"atan":r=e.parse("(1+("+o(r.args[0])+")^2)^(-1)");break;case"abs":S=r.multiplier,r.multiplier=1,v=r.args[0].copy(),v.multiplier=1,r=e.parse(a(o(r.args[0]))+"/abs"+a(o(v))),r.multiplier=S;break;case"parens":r=s(1)}else if(x===h||x===i&&t(r.power)){var A;A=x===h?r.value:x===i&&r.contains(d)?r.baseName+a(o(r.args[0])):r.value+a(o(r.args[0])),m=e.multiply(e.parse("log"+a(A)),r.power.copy()),v=c.diff(e.multiply(e.parse("log"+a(A)),r.power.copy()),d),r=e.multiply(r,v)}else if(x===i&&1!==r.power)v=r.copy(),v.power=1,v.multiplier=1,r=e.multiply(b(r.copy(),d),y(v));else if(x===p||x===u){var k=new s(0);for(var E in r.symbols)k=e.add(k,c.diff(r.symbols[E].copy(),d));r=e.multiply(b(r.copy()),k)}}return r.updateHash(),r}function g(r,t,i){return e.multiply(r,e.parse(t+a(i||o(r.args[0]))))}function w(r){for(var t=r.collectSymbols(),i=new s(0),o=t.length,a=0;o>a;a++){for(var n=c.diff(t[a].copy(),d),l=0;o>l;l++)a!==l&&(n=e.multiply(n,t[l].copy()));i=e.add(i,n)}return i}var d=t(v)?v.text():v;if(void 0===d&&(d=r.Utils.variables(m)[0]),m.group!==i||t(m.power))m=y(m);else{var M=y(m),x=c.diff(m.args[0].copy(),d);m=e.multiply(M,x)}return m}};nerdamer.register([{name:"diff",visible:!0,numargs:[1,2],build:function(){return c.diff}},{name:"sum",visible:!0,numargs:4,build:function(){return c.sum}}])}();var MathNeo={maxIter:100,verbose:!1,newton:function(r,e,t,s){var o,a=[],r=nerdamer(r),n=nerdamer("diff(x)",{x:r}),l=e;for(this.verbose&&console.log("f(x)=",r.text(),"  f'(x)=",n.text()),i=0;o>t||i<=1;i++){var u=nerdamer(r).evaluate({x:l}),p=nerdamer(n).evaluate({x:l}),f=l-u/p;if(i&&(o=Math.abs(f-l),l=f),this.verbose&&console.log(i,l,u.text(),p.text(),o),a.push({n:i,xn:l,fx:u.text(),dfx:p.text(),e:o}),i>s||i>this.maxIter){a.m=!0;break}}return a},bissection:function(r,e,t,i){var s,o=[],r=nerdamer(r),a=1e3,n=e,l=t;for(this.verbose&&console.log("f(x)=",r.text());a>i;){s=(n+l)/2,a=Math.abs(l-n);var u=nerdamer(r).evaluate({x:n}).text(),p=(nerdamer(r).evaluate({x:l}).text(),nerdamer(r).evaluate({x:s}).text());if("0"==p||i>a){this.verbose&&console.log(s),o.push({m:s});break}var f=parseFloat(u)>0,h=(parseFloat(u)>0,parseFloat(p)>0);this.verbose&&console.log(n,l,s,h?"+":"-",a),o.push({a:n,b:l,m:s,s:h?"+":"-",e:a}),f==h?n=s:l=s}return o}};